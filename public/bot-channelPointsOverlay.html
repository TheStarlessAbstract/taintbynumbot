<!DOCTYPE html>
<html>
    <head>
        <title>Socket.IO chat</title>
        <link rel="icon" href="data:;base64,iVBORw0KGgo=">
    </head>
    <body>
        <audio id="myAudio">
            <source src="" id="source">
        </audio>
        <script src="/socket.io/socket.io.js"></script>
        <script>
            var socket = io();
            var x = document.getElementById("myAudio"); 
            var source = document.getElementById("source");
            var lastPlayedFinished = true;

            x.addEventListener("ended", () => {
                lastPlayedFinished = true;
            }, false);

            socket.on("playAudio", (url) => {
                if(lastPlayedFinished){
                    source.src = url;
                x.load();
                x.play();

                lastPlayedFinished = false;
                }
                
            });
        </script>
    </body>
</html>